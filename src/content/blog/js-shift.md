---
draft: false
title: "Powerful jscodeshift"
snippet: ""
image:
  {
    src: "data:image/jpeg;base64,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",
    alt: "React.cloneElement is fragile and expensive",
  }
publishDate: "2024-6-28 21:00"
category: "tools"
author: "x.d"
tags: [tools]
---

In code development, most of the times a find and replace would be suffice to do a straight forwrd replacement. Though other times, a mass replacement becomes humanly impossible. As we snowball more and more data, wrestle with more and more code, a categorical sort of code update can only be done by yet another tool.

[jscodeshift](https://github.com/facebook/jscodeshift) is such a tool.

## My mass code update need

Recently, i found myself painstakingly trying to replace the second argument of a function call with something else. After half of an hour of copying and pasting, I lost my spirit. Instead, I spent another hour researching automated tools with the help of AI (sigh). The result is jscodeshift and the following code.

```
// Import the necessary modules
const j = require('/usr/local/lib/node_modules/jscodeshift');

// This function will be called for each file
module.exports = function (fileInfo, api) {
	console.log(fileInfo.path);
	// Parse the source code into an AST
	const root = j(fileInfo.source);

  root
    .find(j.CallExpression, {
      callee: {
        name: 'sx',
      },
    })
    .forEach((path) => {
      // If the call has more than two arguments, replace the second argument with the third
      if (path.node.arguments.length === 2) {
        path.node.arguments.splice(1, 1);
      } else if (path.node.arguments.length > 2) {
        path.node.arguments[1] = 'undefined';
      }
    });

  // Find all import declarations from '@media-platforms/theme-system'
  root
    .find(j.ImportDeclaration, {
      source: {
        type: 'Literal',
        value: '@media-platforms/theme-system',
      },
    })
    .remove();

	// Print the modified source code
	return root.toSource();
};

```

The code does 2 things:

1. replace the 2nd argument of a function call named `sx` with `undefined`
2. remove the library import now I no longer need

Then all it is left to do is run the script:

```
// run against one file
npx jscodeshift -t path/to/your/script.js path/to/your/code
```

```
// run against a directory
npx jscodeshift -t path/to/your/script.js -d -p path/to/your/code

```
